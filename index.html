<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>60 ê°€ì¹˜ ì¹´ë“œ íƒìƒ‰ê¸° - 3ë‹¨ê³„ ìµœì¢… ì••ì¶•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap');
        
        :root {
            --primary-blue: #2563eb;
            --primary-light: #eff6ff;
        }

        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);
            min-height: 100vh;
            touch-action: manipulation;
        }
        
        .card-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); 
            gap: 12px; 
        }

        @media (max-width: 480px) {
            .card-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
        }

        .flip-card {
            background-color: transparent;
            perspective: 1000px;
            aspect-ratio: 1 / 1.35;
            cursor: pointer;
            width: 100%;
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-style: preserve-3d;
        }

        .flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.4);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .flip-card-front {
            background: #ffffff;
            color: #334e68;
        }

        .flip-card-back {
            background: linear-gradient(145deg, #3b82f6, #1d4ed8);
            color: white;
            transform: rotateY(180deg);
        }

        .selected-wrapper .flip-card-front {
            background-color: #dbeafe;
            border-color: #3b82f6;
            color: #1e40af;
        }

        .selected-wrapper {
            box-shadow: 0 0 0 4px #60a5fa, 0 10px 20px rgba(37, 99, 235, 0.3) !important;
            border-radius: 16px;
        }

        .selected-wrapper .flip-card-front::after {
            content: 'âœ“';
            position: absolute;
            top: 8px;
            right: 10px;
            font-weight: 900;
            font-size: 14px;
            color: #3b82f6;
        }

        .stage-transition { transition: opacity 0.3s ease; }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        .result-card {
            width: 100%;
            max-width: 180px;
            aspect-ratio: 1 / 1.3;
        }

        @media (max-width: 640px) {
            .result-card {
                max-width: 140px;
            }
        }

        #confirmModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="p-3 sm:p-6 md:p-10">
    <div id="app" class="max-w-6xl mx-auto">
        <header class="mb-6 sm:mb-10 text-center">
            <h1 class="text-2xl sm:text-4xl font-black text-slate-800 tracking-tight">ğŸ’ ë‚˜ì˜ 60 ê°€ì¹˜ ë‚˜ì¹¨ë°˜</h1>
            <p class="text-slate-500 mt-2 text-sm sm:text-lg px-4">ê°€ì¥ ì†Œì¤‘í•œ 3ê°€ì§€ ê°€ì¹˜ë¥¼ ì°¾ëŠ” ì—¬ì •ì…ë‹ˆë‹¤.</p>
        </header>

        <!-- Stage 1: Selection -->
        <div id="stage1" class="stage-transition">
            <div class="bg-white/70 backdrop-blur-md rounded-3xl shadow-xl p-4 sm:p-8 mb-6 border border-white/50">
                <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
                    <div class="text-center sm:text-left">
                        <h2 class="text-xl sm:text-2xl font-bold text-slate-800">1ë‹¨ê³„: ê°€ì¹˜ íƒìƒ‰</h2>
                        <p class="text-xs sm:text-sm text-slate-500">ì¹´ë“œë¥¼ ë’¤ì§‘ì–´ë³´ê³  10ê°œ ì´ìƒ ì„ íƒí•˜ì„¸ìš”.</p>
                    </div>
                    <div class="bg-blue-600 px-6 py-2 rounded-full shadow-lg flex items-center gap-2">
                        <span id="counter" class="text-2xl font-black text-white">0</span>
                        <span class="text-blue-100 text-xs font-bold uppercase">Selected</span>
                    </div>
                </div>
                
                <div id="cardContainer" class="card-grid"></div>
            </div>
            
            <div class="sticky bottom-4 sm:bottom-10 text-center z-50">
                <button onclick="goToStage2()" id="nextBtn" class="w-full sm:w-auto bg-slate-300 text-white px-10 py-4 rounded-2xl font-bold shadow-2xl transition-all cursor-not-allowed text-lg" disabled>
                    10ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”
                </button>
            </div>
        </div>

        <!-- Stage 2: Filtering to 5 -->
        <div id="stage2" class="hidden stage-transition">
            <div class="bg-white/80 backdrop-blur-md rounded-3xl shadow-xl p-4 sm:p-8 mb-6 border border-white">
                <h2 class="text-2xl font-bold text-slate-800 mb-2 text-center">2ë‹¨ê³„: í•µì‹¬ ê°€ì¹˜ ê³ ë¥´ê¸°</h2>
                <p class="text-blue-600 text-sm sm:text-lg font-medium mb-6 text-center">1ì°¨ì ìœ¼ë¡œ 5ê°€ì§€ë§Œ ë‚¨ì„ ë•Œê¹Œì§€ ì œì™¸í•˜ì„¸ìš”.</p>
                <div id="filterContainer2" class="card-grid"></div>
            </div>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-10">
                <button onclick="backToStage1()" class="text-slate-500 font-bold p-2">â† ë‹¤ì‹œ ê³ ë¥´ê¸°</button>
                <button onclick="goToStage3()" id="stage3Btn" class="w-full sm:w-auto bg-blue-600 text-white px-12 py-4 rounded-2xl font-bold shadow-2xl hover:bg-blue-700 transition-all text-lg">
                    3ë‹¨ê³„ë¡œ ì´ë™í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- Stage 3: Filtering to 3 -->
        <div id="stage3" class="hidden stage-transition">
            <div class="bg-white/90 backdrop-blur-md rounded-3xl shadow-xl p-4 sm:p-8 mb-6 border border-blue-100">
                <h2 class="text-2xl font-bold text-slate-800 mb-2 text-center">3ë‹¨ê³„: ìµœì¢… ê°€ì¹˜ í™•ì •</h2>
                <p class="text-indigo-600 text-sm sm:text-lg font-medium mb-6 text-center">ì¸ìƒì—ì„œ ê°€ì¥ í¬ê¸°í•  ìˆ˜ ì—†ëŠ” 3ê°€ì§€ë§Œ ë‚¨ê²¨ì£¼ì„¸ìš”.</p>
                <div id="filterContainer3" class="card-grid"></div>
            </div>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-10">
                <button onclick="backToStage2()" class="text-slate-500 font-bold p-2">â† ì´ì „ ë‹¨ê³„ë¡œ</button>
                <button onclick="finalize()" id="finalizeBtn" class="w-full sm:w-auto bg-blue-600 text-white px-12 py-4 rounded-2xl font-bold shadow-2xl hover:bg-blue-700 transition-all text-lg">
                    ìµœì¢… ë¶„ì„ ê²°ê³¼ ë³´ê¸°
                </button>
            </div>
        </div>

        <!-- Stage 4: Result -->
        <div id="result" class="hidden stage-transition">
            <div class="bg-white rounded-3xl shadow-2xl p-6 sm:p-12 text-center border border-white relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1.5 bg-blue-500"></div>
                <h2 class="text-2xl sm:text-4xl font-black text-slate-900 mb-8 sm:mb-12">ë‚˜ì˜ ìµœì¢… 3ê°€ì§€ í•µì‹¬ ê°€ì¹˜</h2>
                
                <div id="finalValues" class="grid grid-cols-1 sm:flex sm:flex-wrap justify-center gap-3 sm:gap-6 mb-10"></div>
                
                <div class="bg-slate-50 p-6 sm:p-10 rounded-2xl text-left border border-slate-200 max-w-4xl mx-auto shadow-inner">
                    <h3 class="font-bold text-slate-900 text-xl mb-4 flex items-center gap-2">
                        <span class="bg-blue-600 w-1.5 h-6 rounded-full"></span>
                        ë‚˜ì˜ ê°€ì¹˜ ì² í•™ ë¶„ì„
                    </h3>
                    <div id="aiAnalysis" class="text-slate-700 leading-relaxed text-sm sm:text-lg space-y-4"></div>
                </div>
                
                <button onclick="resetApp()" class="mt-10 text-slate-400 hover:text-blue-600 text-sm">ì²˜ìŒë¶€í„° ë‹¤ì‹œ í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <!-- í™•ì¸ ëª¨ë‹¬ UI -->
    <div id="confirmModal">
        <div class="bg-white rounded-3xl p-6 max-w-sm w-11/12 text-center shadow-2xl scale-in transform transition-all">
            <div class="text-4xl mb-4">ğŸ’¡</div>
            <h3 class="text-xl font-bold text-slate-800 mb-2">ê°€ì¹˜ ì œì™¸ í™•ì¸</h3>
            <p id="modalMsg" class="text-slate-600 mb-6 text-sm">ê°€ì¹˜ë¥¼ ëª©ë¡ì—ì„œ ì œì™¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
            <div class="flex gap-3">
                <button onclick="closeModal()" class="flex-1 bg-slate-100 text-slate-500 py-3 rounded-xl font-bold hover:bg-slate-200 transition-colors">ì·¨ì†Œ</button>
                <button onclick="confirmDeletion()" class="flex-1 bg-red-500 text-white py-3 rounded-xl font-bold hover:bg-red-600 shadow-lg shadow-red-200 transition-colors">ì œì™¸í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'flip') {
                osc.frequency.setValueAtTime(400, now);
                osc.frequency.exponentialRampToValueAtTime(100, now + 0.1);
                gain.gain.setValueAtTime(0.05, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                osc.start(now); osc.stop(now + 0.1);
            } else if (type === 'select') {
                osc.frequency.setValueAtTime(800, now);
                osc.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
                gain.gain.setValueAtTime(0.05, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                osc.start(now); osc.stop(now + 0.1);
            } else if (type === 'deselect') {
                osc.frequency.setValueAtTime(600, now);
                osc.frequency.exponentialRampToValueAtTime(300, now + 0.1);
                gain.gain.setValueAtTime(0.05, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                osc.start(now); osc.stop(now + 0.1);
            } else if (type === 'success') {
                [523, 659, 783].forEach((f, i) => {
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.connect(g); g.connect(audioCtx.destination);
                    o.frequency.setValueAtTime(f, now + i * 0.1);
                    g.gain.setValueAtTime(0.05, now + i * 0.1);
                    g.gain.exponentialRampToValueAtTime(0.01, now + i * 0.1 + 0.3);
                    o.start(now + i * 0.1); o.stop(now + i * 0.1 + 0.3);
                });
            }
        }

        const allValues = [
            { name: "ì„±ì¥", desc: "ëŠì„ì—†ì´ ë°°ìš°ê³  ì–´ì œë³´ë‹¤ ì„±ìˆ™í•œ ë‚´ê°€ ë˜ê¸° ìœ„í•´ ì •ì§„í•©ë‹ˆë‹¤." },
            { name: "ë„ì „", desc: "ì‹¤íŒ¨ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ì˜ì—­ì— ê¸°êº¼ì´ ë§ì„­ë‹ˆë‹¤." },
            { name: "ì „ë¬¸ì„±", desc: "ë‚´ê°€ ì„ íƒí•œ ë¶„ì•¼ì—ì„œ ìµœê³ ì˜ ì‹¤ë ¥ì„ ìŒ“ìŠµë‹ˆë‹¤." },
            { name: "ììœ ", desc: "ë‚´ ì‚¶ì˜ ì£¼ì¸ì´ ë˜ì–´ ìŠ¤ìŠ¤ë¡œ ì„ íƒí•˜ê³  ì±…ì„ì§€ëŠ” ì‚¶ì„ ì§€í–¥í•©ë‹ˆë‹¤." },
            { name: "ì„ í•œ ì˜í–¥ë ¥", desc: "ë‚˜ì˜ í–‰ë™ì´ íƒ€ì¸ì—ê²Œ ê¸ì •ì ì¸ ë³€í™”ë¥¼ ì¼ìœ¼í‚¤ê¸¸ ë°”ëë‹ˆë‹¤." },
            { name: "ê°€ì¡±", desc: "ì†Œì¤‘í•œ ì‚¬ëŒë“¤ì„ ì¸ìƒì˜ ê°€ì¥ ìš°ì„ ìˆœìœ„ì— ë‘¡ë‹ˆë‹¤." },
            { name: "ê±´ê°•", desc: "ëª¸ê³¼ ë§ˆìŒì˜ ì—ë„ˆì§€ë¥¼ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì‚¶ì˜ ê¸°ì´ˆì„ì„ ë¯¿ìŠµë‹ˆë‹¤." },
            { name: "ê²¸ì†", desc: "ìì‹ ì˜ ì„±ì·¨ë¥¼ ê³¼ì‹œí•˜ì§€ ì•Šê³  ëŠ˜ ë°°ìš°ëŠ” ìì„¸ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤." },
            { name: "ê²½ì²­", desc: "ë‚´ ì£¼ì¥ì„ ì•ì„¸ìš°ê¸°ë³´ë‹¤ íƒ€ì¸ì˜ ì†Œë¦¬ì— ê·€ë¥¼ ê¸°ìš¸ì…ë‹ˆë‹¤." },
            { name: "ê³µì •", desc: "ì–´ë– í•œ ìƒí™©ì—ì„œë„ í¸ê²¬ ì—†ì´ ë°”ë¥´ê²Œ í–‰ë™í•©ë‹ˆë‹¤." },
            { name: "ê´€ê³„", desc: "ì£¼ë³€ ì‚¬ëŒë“¤ê³¼ ê¹Šì€ ìœ ëŒ€ê°ì„ í˜•ì„±í•˜ê³  ì†Œí†µí•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤." },
            { name: "ê°ì‚¬", desc: "ì£¼ì–´ì§„ ì‘ì€ ì¼ìƒì—ì„œë„ ê¸°ì¨ê³¼ ê³ ë§ˆì›€ì„ ì°¾ì•„ëƒ…ë‹ˆë‹¤." },
            { name: "ëˆê¸°", desc: "í•œë²ˆ ì‹œì‘í•œ ì¼ì€ ì–´ë– í•œ ë‚œê´€ì´ ìˆì–´ë„ ë§ˆë¬´ë¦¬ì§€ì–´ëƒ…ë‹ˆë‹¤." },
            { name: "ë‚˜ëˆ”", desc: "ë‚´ê°€ ê°€ì§„ ê²ƒì„ ì£¼ë³€ê³¼ ì•„ë‚Œì—†ì´ ê³µìœ í•©ë‹ˆë‹¤." },
            { name: "ë‚™ì²œ", desc: "ë°ê³  ê¸ì •ì ì¸ íƒœë„ë¡œ ì‚¶ì˜ íŒŒë„ë¥¼ ë„˜ê¹ë‹ˆë‹¤." },
            { name: "ë‹¤ì–‘ì„±", desc: "ì„œë¡œ ë‹¤ë¥¸ ìƒê°ê³¼ ê°€ì¹˜ë¥¼ ì¡´ì¤‘í•©ë‹ˆë‹¤." },
            { name: "ì–‘ì‹¬", desc: "ë‚´ë©´ì˜ ëª©ì†Œë¦¬ì— ê·€ ê¸°ìš¸ì—¬ ë¶€ë„ëŸ¬ì›€ ì—†ì´ ì˜¬ë°”ë¥¸ ê¸¸ì„ ê±·ìŠµë‹ˆë‹¤." },
            { name: "í¬ìƒ", desc: "ë‚˜ë³´ë‹¤ ë” í° ê°€ì¹˜ë‚˜ íƒ€ì¸ì„ ìœ„í•´ ê¸°êº¼ì´ ìì‹ ì„ ë‚´ì–´ì¤ë‹ˆë‹¤." },
            { name: "ë…ë¦½", desc: "ì˜ì¡´í•˜ì§€ ì•Šê³  ìŠ¤ìŠ¤ë¡œì˜ í˜ìœ¼ë¡œ ì¸ìƒì„ ê°œì²™í•©ë‹ˆë‹¤." },
            { name: "ëª…ì˜ˆ", desc: "ìì‹ ê³¼ ê³µë™ì²´ì— ë¶€ë„ëŸ½ì§€ ì•Šì€ í’ˆìœ„ ìˆëŠ” ì‚¶ì„ ì¶”êµ¬í•©ë‹ˆë‹¤." },
            { name: "ëª¨í—˜", desc: "ì•ˆì •ë³´ë‹¤ëŠ” ë‚¯ì„  ê³³ì—ì„œì˜ ë°œê²¬ì„ ì„ í˜¸í•©ë‹ˆë‹¤." },
            { name: "ëª°ì…", desc: "í˜„ì¬ í•˜ê³  ìˆëŠ” ì¼ì— ì˜¨ ì •ì‹ ì„ ì§‘ì¤‘í•©ë‹ˆë‹¤." },
            { name: "ì›Œë¼ë°¸", desc: "ì¼ê³¼ ê°œì¸ì˜ ì‚¶ ì‚¬ì´ì˜ ê±´ê°•í•œ ì¡°í™”ë¥¼ ìœ ì§€í•˜ë©° í–‰ë³µì„ ì°¾ìŠµë‹ˆë‹¤." },
            { name: "ë³€í™”", desc: "ëŠì„ì—†ì´ ìƒˆë¡œìš´ ëª¨ìŠµìœ¼ë¡œ ì§„í™”í•©ë‹ˆë‹¤." },
            { name: "ë°°ë ¤", desc: "ìƒëŒ€ë°©ì˜ ë§ˆìŒì„ ë¨¼ì € í—¤ì•„ë¦¬ê³  ë”°ëœ»í•˜ê²Œ ëŒ€í•©ë‹ˆë‹¤." },
            { name: "ë°°ì›€", desc: "ì„¸ìƒì˜ ì§€í˜œë¥¼ í–¥í•´ í‰ìƒ ë™ì•ˆ ê³µë¶€í•˜ëŠ” ì‚¶ì„ ì‚½ë‹ˆë‹¤." },
            { name: "ë´‰ì‚¬", desc: "ì„¸ìƒì„ ìœ„í•´ í—Œì‹ í•˜ë©° ì‚¶ì˜ ì§„ì •í•œ ë³´ëŒì„ ì°¾ìŠµë‹ˆë‹¤." },
            { name: "ë¶€ìœ ", desc: "ë¬¼ì§ˆì , ì •ì‹ ì  í’ìš”ë¥¼ ìŒ“ìŠµë‹ˆë‹¤." },
            { name: "ì‚¬ë‘", desc: "ë‚˜ë¥¼ ì‚¬ë‘í•˜ê³ , íƒ€ì¸ì„ ë”°ëœ»í•˜ê²Œ í’ˆìŠµë‹ˆë‹¤." },
            { name: "ì„±ì‹¤", desc: "ì˜¤ëŠ˜ì˜ í•œ ê±¸ìŒì„ ë¬µë¬µíˆ ì„±ì‹¤í•˜ê²Œ ê±·ìŠµë‹ˆë‹¤." },
            { name: "ì„±ì·¨", desc: "ëª©í‘œë¥¼ ë‹¬ì„±í–ˆì„ ë•Œ ë³´ëŒê³¼ í¬ì—´ì„ ëŠë‚ë‹ˆë‹¤." },
            { name: "ì†Œì†ê°", desc: "ê³µë™ì²´ ì•ˆì—ì„œ í•¨ê»˜ í˜‘ë ¥í•˜ë©° ì¡°í™”ë¥¼ ì´ë£¹ë‹ˆë‹¤." },
            { name: "ì‹ ë¢°", desc: "ë¯¿ìŒì„ í†µí•´ ëˆ„êµ¬ë‚˜ ê¸°ëŒˆ ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ ë©ë‹ˆë‹¤." },
            { name: "ì•ˆì •", desc: "í‰ì˜¨í•˜ê³  ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì‚¶ì—ì„œ í¸ì•ˆí•¨ì„ ëŠë‚ë‹ˆë‹¤." },
            { name: "ì• êµ­", desc: "ì‚¬íšŒì™€ êµ­ê°€ì˜ ë°œì „ì„ ìœ„í•´ ì±…ì„ê°ì„ ê°–ìŠµë‹ˆë‹¤." },
            { name: "ì—´ì •", desc: "ê°€ìŠ´ ë›°ëŠ” ì¼ì— ëª¨ë“  ì—ë„ˆì§€ë¥¼ ìŸì•„ë¶“ìŠµë‹ˆë‹¤." },
            { name: "ì°½ì¡°", desc: "ìƒˆë¡œìš´ ê°€ì¹˜ë‚˜ ê²°ê³¼ë¬¼ì„ ì„¸ìƒì— ë§Œë“¤ì–´ ë‚´ì–´ ì˜ê°ì„ ì¤ë‹ˆë‹¤." },
            { name: "ìš©ê¸°", desc: "ë‘ë ¤ì›€ì—ë„ ë¶ˆêµ¬í•˜ê³  ë§ˆë•…íˆ í•´ì•¼ í•  ì¼ì„ í–‰ë™í•©ë‹ˆë‹¤." },
            { name: "ìœ ë¨¸", desc: "ì–´ë ¤ìš´ ìˆœê°„ì—ë„ ì›ƒìŒì„ ìƒì§€ ì•ŠìŠµë‹ˆë‹¤." },
            { name: "ìœ ëŠ¥", desc: "ë¬¸ì œë¥¼ ëª…ì¾Œí•˜ê²Œ í•´ê²°í•˜ëŠ” íƒì›”í•œ ëŠ¥ë ¥ì„ ë°œíœ˜í•©ë‹ˆë‹¤." },
            { name: "ì¸ì •", desc: "ë‚˜ì™€ íƒ€ì¸ì˜ ê°€ì¹˜ë¥¼ ì†”ì§í•˜ê²Œ ì¸ì •í•©ë‹ˆë‹¤." },
            { name: "ì¸ë‚´", desc: "ê²°ì‹¤ì„ ë§ºì„ ë•Œê¹Œì§€ ì°¨ë¶„í•˜ê²Œ ê¸°ë‹¤ë¦½ë‹ˆë‹¤." },
            { name: "ì •ì§", desc: "ìì‹ ì„ ì†ì´ì§€ ì•Šê³  ì°¸ë˜ê²Œ ëŒ€í•©ë‹ˆë‹¤." },
            { name: "ì •ì˜", desc: "ì‚¬íšŒì  ì•½ìë¥¼ ë³´í˜¸í•˜ê³  ì˜¬ë°”ë¥¸ ë„ë¦¬ë¥¼ ì‹¤ì²œí•©ë‹ˆë‹¤." },
            { name: "ì¡´ì¤‘", desc: "ìƒëŒ€ë°©ì˜ ì¸ê²©ê³¼ ê°€ì¹˜ë¥¼ ì†Œì¤‘íˆ ì—¬ê¹ë‹ˆë‹¤." },
            { name: "ì§ˆì„œ", desc: "ê·œì¹™ì„ ì§€í‚¤ë©° ì¡°í™”ë¡œìš´ ì‚¬íšŒë¥¼ ë§Œë“­ë‹ˆë‹¤." },
            { name: "ì§€í˜œ", desc: "ë³¸ì§ˆì„ ê¿°ëš«ëŠ” í†µì°°ë ¥ìœ¼ë¡œ í˜„ëª…í•˜ê²Œ íŒë‹¨í•©ë‹ˆë‹¤." },
            { name: "ì°½ì˜", desc: "ìƒˆë¡œìš´ ê´€ì ìœ¼ë¡œ ê°€ì¹˜ë¥¼ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤." },
            { name: "ì±…ì„", desc: "ë§ê³¼ í–‰ë™ì˜ ê²°ê³¼ì— ëŒ€í•´ ëê¹Œì§€ ì±…ì„ì„ ì§‘ë‹ˆë‹¤." },
            { name: "í‰í™”", desc: "ê°ˆë“±ì„ ì¹˜ìœ í•˜ê³  ë§ˆìŒì˜ ì•ˆì‹ì„ ì°¾ìŠµë‹ˆë‹¤." },
            { name: "í•¨ê»˜", desc: "í˜¼ìê°€ ì•„ë‹Œ ìš°ë¦¬ë¡œ ë‚˜ì•„ê°ì„ ë¯¿ìŠµë‹ˆë‹¤." },
            { name: "íš¨ë„", desc: "ë¶€ëª¨ë‹˜ì˜ ì€í˜œì— ë³´ë‹µí•˜ëŠ” ë§ˆìŒì„ ì‹¤ì²œí•©ë‹ˆë‹¤." },
            { name: "íšŒë³µíƒ„ë ¥ì„±", desc: "ë„˜ì–´ì ¸ë„ ë‹¤ì‹œ ì¼ì–´ë‚˜ëŠ” ë§ˆìŒì˜ ê·¼ë ¥ì„ í‚¤ì›ë‹ˆë‹¤." },
            { name: "ì§„ì •ì„±", desc: "ê°€ë©´ì„ ì“°ì§€ ì•Šê³  ì§„ì‹¤í•œ ë‚˜ì˜ ëª¨ìŠµ ê·¸ëŒ€ë¡œ ì†Œí†µí•©ë‹ˆë‹¤." },
            { name: "í˜¸ê¸°ì‹¬", desc: "ì„¸ìƒì„ í–¥í•´ ëŠì„ì—†ì´ ì§ˆë¬¸í•©ë‹ˆë‹¤." },
            { name: "ì ˆì œ", desc: "ìŠ¤ìŠ¤ë¡œë¥¼ ë‹¤ìŠ¤ë¦¬ê³  ì¤‘ìš©ì„ ì§€í‚µë‹ˆë‹¤." },
            { name: "ìœ ì—°ì„±", desc: "ë³€í™”ì— ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•˜ë©° ëŒ€ì•ˆì„ ì°¾ìŠµë‹ˆë‹¤." },
            { name: "ì—¬ìœ ", desc: "ê³¼ì • ìì²´ë¥¼ ì¦ê¸°ë©° ë§ˆìŒì˜ ì‰¼í‘œë¥¼ ì°ìŠµë‹ˆë‹¤." },
            { name: "ê· í˜•", desc: "ì¼ê³¼ ì‚¶ì˜ ê±´ê°•í•œ ì¡°í™”ë¥¼ ì´ë£¹ë‹ˆë‹¤." },
            { name: "ìœ ëŒ€ê°", desc: "íƒ€ì¸ê³¼ ê¹Šì´ ì—°ê²°ë˜ì–´ ì„œë¡œë¥¼ ì‘ì›í•©ë‹ˆë‹¤." }
        ];

        let selectedCards = new Set();
        let itemToPendingDelete = null;
        let currentFilteringStage = 2; // 2 ë˜ëŠ” 3

        function init() {
            const container = document.getElementById('cardContainer');
            allValues.forEach(item => {
                const flipCard = document.createElement('div');
                flipCard.className = "flip-card";
                flipCard.id = `card-${item.name}`;
                flipCard.innerHTML = `
                    <div class="flip-card-inner">
                        <div class="flip-card-front" onclick="handleFlip(this.parentElement.parentElement)">
                            <div class="text-[9px] text-slate-300 mb-4 uppercase tracking-tighter">Flip to see</div>
                            <div class="text-base sm:text-lg font-bold">${item.name}</div>
                        </div>
                        <div class="flip-card-back" onclick="handleFlip(this.parentElement.parentElement)">
                            <div class="text-xs font-bold mb-2 opacity-80 uppercase tracking-widest">${item.name}</div>
                            <div class="text-[11px] sm:text-[13px] leading-snug mb-4 px-1">${item.desc}</div>
                            <button onclick="toggleSelect('${item.name}', event)" class="select-btn bg-white text-blue-600 w-full py-2.5 rounded-xl font-bold text-xs sm:text-sm shadow-md active:scale-95 transition-transform">ì„ íƒí•˜ê¸°</button>
                        </div>
                    </div>
                `;
                container.appendChild(flipCard);
            });
        }

        function handleFlip(el) {
            playSound('flip');
            el.classList.toggle('flipped');
        }

        function toggleSelect(name, event) {
            event.stopPropagation();
            const cardEl = document.getElementById(`card-${name}`);
            const inner = cardEl.querySelector('.flip-card-inner');
            const btn = cardEl.querySelector('.select-btn');

            if (selectedCards.has(name)) {
                selectedCards.delete(name);
                inner.classList.remove('selected-wrapper');
                btn.innerText = "ì„ íƒí•˜ê¸°";
                btn.className = "select-btn bg-white text-blue-600 w-full py-2.5 rounded-xl font-bold text-xs sm:text-sm shadow-md active:scale-95 transition-transform";
            } else {
                playSound('select');
                selectedCards.add(name);
                inner.classList.add('selected-wrapper');
                btn.innerText = "âœ“ ì„ íƒë¨";
                btn.className = "select-btn bg-green-400 text-white w-full py-2.5 rounded-xl font-bold text-xs sm:text-sm shadow-inner active:scale-95 transition-transform";
            }
            updateUI();
        }

        function updateUI() {
            const count = selectedCards.size;
            document.getElementById('counter').innerText = count;
            const btn = document.getElementById('nextBtn');
            if (count >= 10) {
                btn.disabled = false;
                btn.classList.replace('bg-slate-300', 'bg-blue-600');
                btn.innerText = "2ë‹¨ê³„ë¡œ ì´ë™í•˜ê¸°";
            } else {
                btn.disabled = true;
                btn.classList.replace('bg-blue-600', 'bg-slate-300');
                btn.innerText = `${10 - count}ê°œ ë” ì„ íƒí•´ì£¼ì„¸ìš”`;
            }
        }

        function goToStage2() {
            playSound('success');
            currentFilteringStage = 2;
            document.getElementById('stage1').classList.add('hidden');
            document.getElementById('stage2').classList.remove('hidden');
            renderFilteringStage('filterContainer2', 5, 'stage3Btn');
            window.scrollTo(0,0);
        }

        function goToStage3() {
            playSound('success');
            currentFilteringStage = 3;
            document.getElementById('stage2').classList.add('hidden');
            document.getElementById('stage3').classList.remove('hidden');
            renderFilteringStage('filterContainer3', 3, 'finalizeBtn');
            window.scrollTo(0,0);
        }

        function backToStage1() {
            document.getElementById('stage2').classList.add('hidden');
            document.getElementById('stage1').classList.remove('hidden');
        }

        function backToStage2() {
            currentFilteringStage = 2;
            document.getElementById('stage3').classList.add('hidden');
            document.getElementById('stage2').classList.remove('hidden');
            renderFilteringStage('filterContainer2', 5, 'stage3Btn');
        }

        function renderFilteringStage(containerId, targetCount, buttonId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            Array.from(selectedCards).forEach(name => {
                const item = allValues.find(v => v.name === name);
                const card = document.createElement('div');
                card.className = "bg-blue-500 text-white p-4 rounded-2xl aspect-square flex flex-col justify-center items-center text-center relative overflow-hidden active:bg-red-500 transition-colors";
                card.innerHTML = `
                    <div class="font-bold text-lg mb-1">${item.name}</div>
                    <div class="text-[9px] opacity-70 line-clamp-2 px-1">ì œì™¸í•˜ë ¤ë©´ í´ë¦­</div>
                `;
                card.onclick = () => openModal(name);
                container.appendChild(card);
            });
            updateStageButton(targetCount, buttonId);
        }

        function updateStageButton(targetCount, buttonId) {
            const btn = document.getElementById(buttonId);
            if (selectedCards.size === targetCount) {
                btn.disabled = false;
                btn.className = "w-full sm:w-auto bg-green-600 text-white px-12 py-4 rounded-2xl font-bold text-lg shadow-xl active:scale-95 transition-transform";
                btn.innerText = buttonId === 'stage3Btn' ? "3ë‹¨ê³„(ìµœì¢…)ë¡œ ì´ë™" : "ìµœì¢… ë¶„ì„ ë³´ê¸°";
            } else {
                btn.disabled = true;
                btn.className = "w-full sm:w-auto bg-slate-300 text-white px-12 py-4 rounded-2xl font-bold text-lg opacity-50";
                btn.innerText = `${selectedCards.size}ê°œ (${targetCount}ê°œê¹Œì§€ ì¤„ì´ê¸°)`;
            }
        }

        function openModal(name) {
            itemToPendingDelete = name;
            document.getElementById('modalMsg').innerText = `'${name}' ê°€ì¹˜ë¥¼ ì œì™¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
            document.getElementById('confirmModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('confirmModal').style.display = 'none';
            itemToPendingDelete = null;
        }

        function confirmDeletion() {
            if (itemToPendingDelete) {
                playSound('deselect');
                selectedCards.delete(itemToPendingDelete);
                if (currentFilteringStage === 2) {
                    renderFilteringStage('filterContainer2', 5, 'stage3Btn');
                } else {
                    renderFilteringStage('filterContainer3', 3, 'finalizeBtn');
                }
                closeModal();
            }
        }

        function finalize() {
            playSound('success');
            const final = Array.from(selectedCards);
            document.getElementById('stage3').classList.add('hidden');
            document.getElementById('result').classList.remove('hidden');
            window.scrollTo(0,0);
            
            const resDiv = document.getElementById('finalValues');
            resDiv.innerHTML = '';
            final.forEach(name => {
                const item = allValues.find(v => v.name === name);
                const card = document.createElement('div');
                card.className = "result-card bg-gradient-to-br from-blue-600 to-indigo-700 text-white rounded-3xl shadow-xl p-5 flex flex-col items-center justify-center text-center mx-auto";
                card.innerHTML = `<div class="font-bold text-xl mb-3">${item.name}</div><div class="text-[10px] opacity-80 leading-tight">${item.desc}</div>`;
                resDiv.appendChild(card);
            });

            document.getElementById('aiAnalysis').innerHTML = `
                <p>ìˆ˜ë§ì€ ê°€ì¹˜ ì¤‘ ë‹¹ì‹ ì´ ë‚¨ê¸´ <b>[${final.join(', ')}]</b>ì€ ë‹¹ì‹ ì˜ ì‚¶ì„ ì§€íƒ±í•˜ëŠ” ê°€ì¥ ë‹¨ë‹¨í•œ ì •ìˆ˜ì…ë‹ˆë‹¤.</p>
                <p>3ë‹¨ê³„ì˜ ê³ ì‹¬ì„ ê±°ì³ ì„ íƒëœ ì´ ê°€ì¹˜ë“¤ì€ ë‹¹ì‹ ì´ ì¸ìƒì˜ ê°ˆë¦¼ê¸¸ì— ì„°ì„ ë•Œ ê°€ì¥ ì„ ëª…í•œ í•´ë‹µì„ ì¤„ ê²ƒì…ë‹ˆë‹¤. ì´ 3ê°€ì§€ í‚¤ì›Œë“œë¥¼ í•­ìƒ ê¸°ì–µí•˜ê³  ë‚˜ì¹¨ë°˜ìœ¼ë¡œ ì‚¼ìœ¼ì„¸ìš”.</p>
                <p class="font-bold text-blue-600 mt-6 text-lg text-center">"ê°€ì¥ ë³¸ì§ˆì ì¸ 3ê°€ì§€ê°€ ë‹¹ì‹ ì˜ ì‚¶ì„ ìœ„ëŒ€í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤."</p>
            `;
        }

        function resetApp() { location.reload(); }
        window.onload = init;
    </script>
</body>
</html>
